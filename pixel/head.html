<script>
  ;(function() {
    var merchantId = '{{settings.merchantId}}'
    var prefCenter = '{{settings.prefCenterName}}'
    var emailIds = '{{settings.emailInputIds}}'
    var subscriptionPoint = '{{settings.subscriptionPoint}}'
    var subscriptionIds = '{{settings.subscriptionIds}}'
    var useRefIdSetting = '{{settings.useRefId}}'
    if (!merchantId) {
      console.error(
        'Warning: No Listrak Merchant Id is defined. Please configure it in the apps admin.'
      )
      return
    }
    ;(function e() {
      window.__listrak_merchant_id = merchantId
      window.__listrak_pref_center = prefCenter
      window.__listrak_email_ids = emailIds
        ? decodeURIComponent(emailIds).split(',')
        : ''
      window.__listrak_subscription_ids = subscriptionIds
        ? decodeURIComponent(subscriptionIds)
            .split(',')
            .reduce(
              (acc, curr, i, ids) =>
                i % 2 === 0
                  ? acc
                  : [...acc, { input: ids[i - 1], submit: curr }],
              []
            )
        : []
      window.__listrak_subscription_point = subscriptionPoint
        ? decodeURIComponent(subscriptionPoint)
        : ''
      window.__listrak_useRefIdSetting = useRefIdSetting
        ? JSON.parse(useRefIdSetting)
        : false
      var e = document.createElement('script')
      ;(e.type = 'text/javascript'),
        (e.async = true),
        (e.src =
          'https://cdn.listrakbi.com/scripts/script.js?m=' +
          merchantId +
          '&v=1')
      var t = document.getElementsByTagName('script')[0]
      t.parentNode.insertBefore(e, t)
    })()
  })()
</script>
